---
title: Using in-chat authentication
image: "https://og.composio.dev/api/og?title=Using%20In-chat%20Authentication"
description: "Let your agent prompt users to connect accounts during conversation"
keywords: "tool router, authentication, in-chat, MANAGE_CONNECTIONS"
---

In-chat authentication lets your agent prompt users to connect accounts during chat. When a tool requires authentication, the agent returns a Connect Link URL. The user authenticates, confirms in chat, and the agent retries.

## How it works

1. Agent searches for tools via `COMPOSIO_SEARCH_TOOLS`
2. `COMPOSIO_MANAGE_CONNECTIONS` checks connection status, returns Connect Link URL if needed
3. User authenticates, confirms in chat, agent continues

## Configuration

In-chat auth is enabled by default. The `COMPOSIO_MANAGE_CONNECTIONS` meta-tool is included automatically.

<CodeGroup>
```python
session = await composio.create(
    user="user_123",
)
```
```typescript
const { mcp } = await composio.create("user_123");
```
</CodeGroup>

### Custom callback URL

Redirect users to a specific page after authentication:

<CodeGroup>
```python
session = await composio.create(
    user="user_123",
    manage_connections={
        "callback_url": "https://yourapp.com/chat"
    },
)
```
```typescript
const { mcp } = await composio.create("user_123", {
  manageConnections: {
    callbackUrl: "https://yourapp.com/chat",
  },
});
```
</CodeGroup>

### Disabling in-chat auth

To manage authentication outside of chat, disable the `COMPOSIO_MANAGE_CONNECTIONS` tool:

<CodeGroup>
```python
session = await composio.create(
    user="user_123",
    manage_connections=False,
)
```
```typescript
const { mcp } = await composio.create("user_123", {
  manageConnections: false,
});
```
</CodeGroup>

See [Manually authenticating users](/tool-router/manually-authenticating-users) for the alternative approach.

## Examples

<CodeGroup>
<CodeGroupItem title="OpenAI Agents SDK (Python)">
<SnippetCode src="fern/snippets/tool-router/python/in-chat-auth.py" />
</CodeGroupItem>
<CodeGroupItem title="Vercel AI SDK (TypeScript)">
<SnippetCode src="fern/snippets/tool-router/typescript/in-chat-auth.ts" />
</CodeGroupItem>
</CodeGroup>

### Example conversation

```
You: Star the composio repo on GitHub

Agent: I'll help you star the Composio repo. Let me search for the right tools.

I found the tool to star repositories, but I need you to connect your GitHub 
account first. Please click the link below to authorize:
https://connect.composio.dev/link/ln_abc123

You: Done

Agent: Done! I've starred ComposioHQ/composio.
```

